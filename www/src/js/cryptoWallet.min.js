function str2ab(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),a=0,o=e.length;a<o;a++)n[a]=e.charCodeAt(a);return t}function etherscan(e,t,n,a,o){var s="";for(var r in n)n.hasOwnProperty(r)&&(s+=r+"="+n[r]+"&");$.ajax({url:"https://api.etherscan.io/"+e+"/"+t+"?"+s,method:"POST",data:a,success:function(e){o&&o(e)},error:function(e){noty({text:_chat_e("Не удалось загрузить список транзакций"),type:"warning",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}})}})}function ethplorer(e,t,n,a,o){var s="",r="";for(var i in n)n.hasOwnProperty(i)&&(s+=i+"="+n[i]+"&");for(var l in a)a.hasOwnProperty(l)&&(r+=l+"="+a[l]+"&");$.ajax({url:"https://api.ethplorer.io/"+e+"/"+t+"?"+s,method:"POST",data:a,success:function(e){e&&(e=JSON.parse(e)),o&&o(e)},error:function(e){noty({text:_chat_e("Не удалось загрузить список транзакций"),type:"warning",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}}),o&&o({})}})}function createWalletETH(e){var t=keythereum.create({keyBytes:32,ivBytes:16});swal({customClass:"swal-telegraf-modal select-form text-center",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",confirmButtonText:_chat_e("Дальше"),cancelButtonText:_chat_e("Отменить"),showCancelButton:!0,text:'<div class="mv-area code-area-sec"><h3 style="font-size: 28px;">'+_chat_e("Создание аккаунта...")+'</h3><div class="alert alert-warning" style="width:300px;font-size: 14px;margin:0 auto;padding:6px 24px;margin-top:20px;text-align: left;margin-left: -10px;"><div style="width:10%;display:inline-block;    position: relative;top: -55px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 78.561 78.561" style="enable-background:new 0 0 78.561 78.561" xml:space="preserve"><g><g><circle cx="39.28" cy="57.772" r="3.632" style="fill:#8f6d3b"></circle><path d="M38.792,48.347c1.104,0,2-0.896,2-2v-19c0-1.104-0.896-2-2-2s-2,0.896-2,2v19C36.792,47.451,37.688,48.347,38.792,48.347z " style="fill:#8f6d3b"></path><path d="M46.57,11.542l-0.091-0.141c-1.852-2.854-3.766-5.806-7.199-5.806c-3.578,0-5.45,2.994-7.26,5.891 c-0.009,0.014-0.065,0.104-0.074,0.119L0.278,65.266C0.096,65.574,0,65.735,0,66.092c0,3.896,3.135,6.874,6.988,6.874h64.585 c3.854,0,6.988-2.979,6.988-6.874c0-0.357-0.096-0.614-0.277-0.921L46.57,11.542z M71.573,68.966H6.988 c-1.461,0-2.717-0.951-2.95-2.394l31.374-53.061c1.554-2.487,2.572-3.963,3.868-3.963c1.261,0,2.457,1.87,3.843,4.006 l31.399,53.007C74.29,68.003,73.034,68.966,71.573,68.966z" style="fill:#8f6d3b"></path></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></div><div style="width:88%;display:inline-block;margin-left:2%"><strong style="font-weight:600!important">'+_e("Внимание")+"!</strong> "+_e("Этот пароль шифрует ваш закрытый ключ. Он не является способом для генерации ваших ключей. Вам понадобится этот пароль + ваш секретный ключ, чтобы разблокировать ваш кошелек.")+'</div></div><form action="#" onsubmit="return false;" style="margin-top: 20px;"><div class="select-form" style="padding-bottom: 15px;"><label>'+_chat_e("Адрес:")+'</label><input class="form-control" style="font-size: 11px;font-weight: 300;" value="'+keythereum.privateKeyToAddress(t.privateKey)+'" id="phone_f_fff" disabled="disabled"></div><label>'+_chat_e("Пароль для KeyStore File:")+'</label><input class="form-control" placeholder="'+_chat_e("(Пароль: 8-15 символов)")+'" id="code_sms12" autocomplete="off" type="password"></div></form><br></div>'}).then(function(n){var a=$("#code_sms12").val();swal({customClass:"swal-telegraf-modal select-form text-center",title:"Generate you Account...",closeOnConfirm:!1,allowOutsideClick:!1,allowEscapeKey:!0,showConfirmButton:!0,showCancelButton:!1,showLoaderOnConfirm:!0,text:_chat_e("Может занять несколько секунд"),preConfirm:function(){return new Promise(function(e,t){setTimeout(function(){e()},15e3)})}}),swal.showLoading();var o=keythereum.dump(a,t.privateKey,t.salt,t.iv,{kdf:"pbkdf2",cipher:"aes-128-ctr",kdfparams:{c:1024,dklen:32,prf:"hmac-sha256"}}),s=keythereum.exportToFile(o),r=keythereum.privateKeyToAddress(t.privateKey),i=keythereum.generateKeystoreFilename(o.address);setTimeout(function(){swal({customClass:"swal-telegraf-modal select-form text-center",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",confirmButtonText:_chat_e("Скачать файл"),cancelButtonText:_chat_e("Отменить"),allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!0,showCancelButton:!0,text:'<div class="mv-area code-area-sec"><div class="alert alert-warning" style="width:300px;font-size: 14px;margin:0 auto;padding:6px 24px;margin-top:20px;text-align: left;margin-left: -10px;"><div style="width:10%;display:inline-block;    position: relative;top: -55px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 78.561 78.561" style="enable-background:new 0 0 78.561 78.561" xml:space="preserve"><g><g><circle cx="39.28" cy="57.772" r="3.632" style="fill:#8f6d3b"></circle><path d="M38.792,48.347c1.104,0,2-0.896,2-2v-19c0-1.104-0.896-2-2-2s-2,0.896-2,2v19C36.792,47.451,37.688,48.347,38.792,48.347z " style="fill:#8f6d3b"></path><path d="M46.57,11.542l-0.091-0.141c-1.852-2.854-3.766-5.806-7.199-5.806c-3.578,0-5.45,2.994-7.26,5.891 c-0.009,0.014-0.065,0.104-0.074,0.119L0.278,65.266C0.096,65.574,0,65.735,0,66.092c0,3.896,3.135,6.874,6.988,6.874h64.585 c3.854,0,6.988-2.979,6.988-6.874c0-0.357-0.096-0.614-0.277-0.921L46.57,11.542z M71.573,68.966H6.988 c-1.461,0-2.717-0.951-2.95-2.394l31.374-53.061c1.554-2.487,2.572-3.963,3.868-3.963c1.261,0,2.457,1.87,3.843,4.006 l31.399,53.007C74.29,68.003,73.034,68.966,71.573,68.966z" style="fill:#8f6d3b"></path></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></div><div style="width:88%;display:inline-block;margin-left:2%"><strong style="font-weight:600!important">Do not lose it!</strong> It cannot be recovered if you lose it.<br><strong style="font-weight:600!important">Do not share it!</strong> Your funds will be stolen if you use this file on a malicious/phishing site.<br><strong style="font-weight:600!important">Make a backup!</strong> Secure it like the millions of dollars it may one day be worth.</div></div><form action="#" onsubmit="return false;" style="margin-top: 20px;"><div class="select-form"><label>'+_chat_e("Адрес:")+'</label><input class="form-control" style="font-size: 12px;font-weight: 600;" value="'+r+'" id="phone_f_fff" disabled="disabled"></div><label>'+_chat_e("Пароль для KeyStore File:")+'</label><input class="form-control" value="'+a+'" id="code_sms12" autocomplete="off" disabled="disabled"></div><label>PrivateKey:</label><textarea class="form-control" value="" id="code_sms12" autocomplete="off" disabled="disabled">'+t.privateKey.toString("hex")+"</textarea></div></form><br></div>"}).then(function(t){var n=$("#code_sms12").val(),a=window.document.createElement("a");a.href=window.URL.createObjectURL(new Blob([s],{type:"text"})),a.download=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),keythereum.recover(n,o,function(t){e&&e(keythereum.privateKeyToAddress(t.toString("hex")),t.toString("hex"),"ETH")});try{if(window.cordova&&window.cordova.file){var r=new FileTransfer;window.resolveLocalFileSystemURL(cordova.file.dataDirectory,function(e){r.download(window.URL.createObjectURL(new Blob([s],{type:"text"})),e,function(e){console.log("download complete: "+e.toURL())},function(e){console.log("download error source "+e.source),console.log("download error target "+e.target),console.log("download error code"+e.code)},!1,{headers:{Authorization:"Basic dGVzdHVzZXJuYW1lOnRlc3RwYXNzd29yZA=="}})})}}catch(e){console.error("ERR DOWNL FILE 4214: ",e)}}),swal.showLoading()},2500)},function(){swal.close()})}function importFromPrivateKeyETH(e){swal({customClass:"swal-telegraf-modal select-form text-center",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",confirmButtonText:_chat_e("Дальше"),cancelButtonText:_chat_e("Отменить"),showCancelButton:!0,text:'<div class="mv-area code-area-sec"><h3 style="font-size: 28px;">'+_chat_e("Импорт крипто кошелька...")+'</h3><form action="#" onsubmit="return false;" style="margin-top: 20px;"><div class="select-form" style="padding-bottom: 15px;"><label>'+_chat_e("Private Key:")+'</label><input class="form-control" placeholder="0x..................." id="code_sms12" autocomplete="off" type="text"></div></form><br></div>'}).then(function(t){var n=$("#code_sms12").val();e&&e(keythereum.privateKeyToAddress(n),n,"ETH")})}function importFromKeyStoreETH(e,t){swal({customClass:"swal-telegraf-modal select-form text-center",title:"Upload you file...",closeOnConfirm:!1,allowOutsideClick:!1,allowEscapeKey:!0,showConfirmButton:!0,showCancelButton:!1,showLoaderOnConfirm:!0,text:_chat_e("Может занять несколько секунд"),preConfirm:function(){return new Promise(function(e,t){setTimeout(function(){e()},15e3)})}}),swal.showLoading();var n=e.target.files[0];if(n){var a=new FileReader;a.onload=function(e){var n=e.target.result;try{var a=JSON.parse(n);swal({customClass:"swal-telegraf-modal select-form text-center",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",confirmButtonText:_chat_e("Войти"),cancelButtonText:_chat_e("Отменить"),showCancelButton:!0,text:'<div class="mv-area code-area-sec"><h2>'+_chat_e("Восстановление аккаунта:")+'</h2><form action="#" onsubmit="return false;" style="margin-top: 20px;"><div class="select-form"><label>'+_chat_e("Адрес:")+'</label><input class="form-control" style="font-size: 11px;font-weight: 300;" value="0x'+a.address+'" id="phone_f_fff" disabled="disabled"></div><label>'+_chat_e("Пароль")+'</label><input class="form-control" placeholder="'+_chat_e("Пароль от KeyStore File:")+'" id="code_sms12" autocomplete="off" type="password"></div></form><br></div>'}).then(function(){var e=$("#code_sms12").val();swal({customClass:"swal-telegraf-modal select-form text-center",title:"Open you Account...",closeOnConfirm:!1,allowOutsideClick:!1,allowEscapeKey:!0,showConfirmButton:!0,showCancelButton:!1,showLoaderOnConfirm:!0,text:_chat_e("Может занять несколько секунд"),preConfirm:function(){return new Promise(function(e,t){setTimeout(function(){e()},15e3)})}}),swal.showLoading();var n=setTimeout(function(){return swal({customClass:"swal-telegraf-modal select-form text-center",title:_chat_e("Уппс..."),type:"error",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:_chat_e("Неверный файл или пароль!")})},3e3);console.log(keythereum.recover(e,a,function(e){clearTimeout(n),swal.close(),t&&t(keythereum.privateKeyToAddress(e.toString("hex")),e.toString("hex"),"ETH")}))},function(){swal.close()})}catch(e){return swal({customClass:"swal-telegraf-modal select-form text-center",title:_chat_e("Уппс..."),type:"error",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:_chat_e("Файл не является KeyStore File - выберите другой файл.")})}},a.readAsText(n)}}var abi=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"success",type:"bool"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_disable",type:"bool"}],name:"disableTransfers",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,type:"function"},{constant:!0,inputs:[],name:"MiningRewardPerETHBlock",outputs:[{name:"",type:"uint256"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transferFrom",outputs:[{name:"success",type:"bool"}],payable:!1,type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_amount",type:"uint256"}],name:"ChangeMiningReward",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[],name:"version",outputs:[{name:"",type:"string"}],payable:!1,type:"function"},{constant:!0,inputs:[],name:"standard",outputs:[{name:"",type:"string"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_token",type:"address"},{name:"_to",type:"address"},{name:"_amount",type:"uint256"}],name:"withdrawTokens",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[{name:"",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],payable:!1,type:"function"},{constant:!1,inputs:[],name:"acceptOwnership",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_amount",type:"uint256"}],name:"issue",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[],name:"owner",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_amount",type:"uint256"}],name:"destroy",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[{name:"success",type:"bool"}],payable:!1,type:"function"},{constant:!0,inputs:[],name:"transfersEnabled",outputs:[{name:"",type:"bool"}],payable:!1,type:"function"},{constant:!1,inputs:[],name:"TransferMinersReward",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[],name:"newOwner",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!0,inputs:[{name:"",type:"address"},{name:"",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,type:"function"},{constant:!0,inputs:[],name:"lastBlockRewarded",outputs:[{name:"",type:"uint256"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_newOwner",type:"address"}],name:"transferOwnership",outputs:[],payable:!1,type:"function"},{inputs:[{name:"_name",type:"string"},{name:"_symbol",type:"string"},{name:"_decimals",type:"uint8"}],payable:!1,type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"_token",type:"address"}],name:"DebitCoinTokenGenesis",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"_amount",type:"uint256"}],name:"Issuance",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"_amount",type:"uint256"}],name:"Destruction",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"_amount",type:"uint256"}],name:"MiningRewardChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"_from",type:"address"},{indexed:!0,name:"_to",type:"address"},{indexed:!1,name:"_value",type:"uint256"}],name:"MiningRewardSent",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"_prevOwner",type:"address"},{indexed:!1,name:"_newOwner",type:"address"}],name:"OwnerUpdate",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"_from",type:"address"},{indexed:!0,name:"_to",type:"address"},{indexed:!1,name:"_value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"_owner",type:"address"},{indexed:!0,name:"_spender",type:"address"},{indexed:!1,name:"_value",type:"uint256"}],name:"Approval",type:"event"}],_contract_fixed=1e8,_address="0x95408930d6323ac7aa69e6c2cbfe58774d565fa8",contract=!1,Crypto={getBalance:function(e,t,n){return"ETH"===t?(n&&n(e,t,(+web3.eth.getBalance(e)/1e18).toFixed(4)),(+web3.eth.getBalance(e)/1e18).toFixed(4)):"DBC"===t?(contract||(contract=web3.eth.contract(abi).at(_address)),n&&n(e,t,(+contract.balanceOf(e)/_contract_fixed).toFixed(2)),(+contract.balanceOf(e)/_contract_fixed).toFixed(2)):"BTC"===t?(n&&n(e,t,(0).toFixed(6)),(0).toFixed(6)):void 0},find:function(e,t){for(var n in Messenger.crypto.wallets)if(Messenger.crypto.wallets[n].address===e&&Messenger.crypto.wallets[n].type===t)return Messenger.crypto.wallets[n];return!1},transferETH:function(e,t){var n=this.find(e.from,"ETH");if(!n)return swal({customClass:"swal-telegraf-modal select-form text-center",title:_chat_e("Уппс..."),type:"error",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:_chat_e("Не удалось аутентифицировать ваш кошелек")});var a=new ethereumjs.Tx({nonce:ethUtil.intToHex(web3.eth.getTransactionCount(n.address,"pending")),gasPrice:ethUtil.intToHex(1e9*e.gasPrice),gasLimit:ethUtil.intToHex(8e4),to:e.to,from:n.address,value:web3.toHex(web3.toWei(+e.amount,"ether")),chainId:1});a.sign(ethereumjs.Buffer.Buffer(n.privateKey,"hex"));var o=a.serialize();web3.eth.sendRawTransaction("0x"+o.toString("hex"),function(e,n){if(e)return console.error("Error (web3.eth.sendRawTransaction):",e,n),swal({customClass:"swal-telegraf-modal select-form text-center",title:_chat_e("Уппс..."),type:"error",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:_chat_e("Ошибка отправки транзакции")});console.log(n),t&&t(n)})},transferDBC:function(e,t){var n=this.find(e.from,"DBC");if(!n)return swal({customClass:"swal-telegraf-modal select-form text-center",title:_chat_e("Уппс..."),type:"error",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:_chat_e("Не удалось аутентифицировать ваш кошелек")});var a=new ethereumjs.Tx({nonce:ethUtil.intToHex(web3.eth.getTransactionCount(n.address,"pending")),gasPrice:ethUtil.intToHex(1e9*e.gasPrice),gasLimit:ethUtil.intToHex(8e4),to:_address,from:n.address,value:"0x00",data:contract.transfer.getData(e.to,+e.amount*_contract_fixed),chainId:1});a.sign(ethereumjs.Buffer.Buffer(n.privateKey,"hex"));var o=a.serialize();web3.eth.sendRawTransaction("0x"+o.toString("hex"),function(e,n){if(e)return console.error("Error (web3.eth.sendRawTransaction):",e,n),swal({customClass:"swal-telegraf-modal select-form text-center",title:_chat_e("Уппс..."),type:"error",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:_chat_e("Ошибка отправки транзакции")});console.log(n),t&&t(n)})},transferERC20:function(e,t){var n=this.find(e.from,find);if(!n)return swal({customClass:"swal-telegraf-modal select-form text-center",title:_chat_e("Уппс..."),type:"error",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:_chat_e("Не удалось аутентифицировать ваш кошелек")});var a=new ethereumjs.Tx({nonce:ethUtil.bufferToHex(web3.eth.getTransactionCount(n.address,"pending")),gasPrice:ethUtil.bufferToHex(1e9*e.gasPrice),gasLimit:ethUtil.bufferToHex(8e4),to:e.to,from:n.address,value:web3.toHex(web3.toWei(+e.amount,"ether")),chainId:1});a.sign(ethereumjs.Buffer.Buffer(n.privateKey));var o=a.serialize();web3.eth.sendRawTransaction("0x"+o.toString("hex"),function(e,n){if(e)return console.error("Error (web3.eth.sendRawTransaction):",e,n),swal({customClass:"swal-telegraf-modal select-form text-center",title:_chat_e("Уппс..."),type:"error",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:_chat_e("Ошибка отправки транзакции")});t&&t(n)})}};