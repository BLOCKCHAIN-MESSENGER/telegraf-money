var WtcAffiliates=Ractive.extend({data:function(){return{}},oninit:function(){console.log("Affiliates.oninit !"),ractiveComponent["wtc-AffiliatesApp"].set("MyProfile",MyProfile),Messenger.finance.callback_save(function(e,t){ractiveComponent["wtc-AffiliatesApp"].set("finance_cards",e),ractiveComponent["wtc-AffiliatesApp"].set("finance_cards_load",!0)}),Messenger.body.Affiliates.callback=function(){ractiveComponent["wtc-AffiliatesApp"].set("tabPage",Messenger.body.Affiliates.tabPage),"profit"==Messenger.body.Affiliates.tabPage&&API("get_partners_expected_income",{},!1,function(e){e&&e.incame?ractiveComponent["wtc-AffiliatesApp"].set("profit",e.incame.filter(function(e){return!!(e.date_kontract&&new Date(e.date_kontract)>new Date("2017-04-11"))})):ractiveComponent["wtc-AffiliatesApp"].set("profit",[]),ractiveComponent["wtc-AffiliatesApp"].set("profit_load",!0)},!1),$("#cards_my").styler().trigger("refresh"),$(".__nano").nanoScroller()},Messenger.partners.callback_save(function(e){ractiveComponent["wtc-AffiliatesApp"].set("partners",e),ractiveComponent["wtc-AffiliatesApp"].set("partners_finish",!0)}),Messenger.body.Affiliates.callback(),API("getPartnerTxDebitCoin",{},!1,function(e){e.partner&&e.partner[0]&&e.partner[0].referal||(e.partner=[{referal:10}]);var t=0;for(var n in e.txes){e.txes[n].period&&1!=+e.txes[n].period?2==+e.txes[n].period?.1743:3==+e.txes[n].period?.4324:4==+e.txes[n].period?.7533234:5==+e.txes[n].period?.6:6==+e.txes[n].period?.75:7==+e.txes[n].period?.6:1:.1248;var a=moment(e.txes[n].update_at),o=a.format("DD.MM.YYYY"),r=a.format("HH:mm");e.txes[n].date=o,e.txes[n].time=r,e.txes[n].partner_profit=0,"1"===e.txes[n].pay_status&&(e.txes[n].partner_profit=+(+e.txes[n].dbc/100*+e.partner[0].referal).toFixed(2)),t+=e.txes[n].partner_profit,e.txes[n].type_="+"}ractiveComponent["wtc-DebitcoinApp"].set("transactions_partner",e.txes),ractiveComponent["wtc-DebitcoinApp"].set("total_proff",t.toFixed(2)),ractiveComponent["wtc-DebitcoinApp"].set("transactions_partner_info",e.partner[0])})},onrender:function(){console.log("Affiliates.onrender !")},oncomplete:function(){console.log("Affiliates.oncomplete !")}});ractiveComponent["wtc-AffiliatesApp"].on("add_share",function(e,t){swal({title:_chat_e("Добавить партнера"),customClass:"swal-telegraf-modal",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",confirmButtonText:_chat_e("Поделиться"),cancelButtonText:_chat_e("Закрыть"),showCancelButton:!0,html:_chat_e("Ваша реферальная ссылка: ")+'<br><div class="select-form"><input class="form-control" value="https://telegraf.money/?ref='+MyProfile.webtransfer_id+'" ></div><br>'+_chat_e("Приглашайте ваших друзей в Telegraf.Money и получайте по $50 кредитным бонусом на вашу карту за каждого из них. Ваши друзья также получат по $50, зарегистрировавшись по вашей ссылке.")}).then(function(){Messenger.share()})}),ractiveComponent["wtc-AffiliatesApp"].on("addPartner",function(e,t){swal({title:_chat_e("Добавить партнера"),customClass:"swal-telegraf-modal",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",confirmButtonText:_chat_e("Поделиться"),cancelButtonText:_chat_e("Закрыть"),showCancelButton:!0,html:_chat_e("Ваша реферальная ссылка: ")+'<br><div class="select-form"><input class="form-control" value="https://telegraf.money/?ref='+MyProfile.webtransfer_id+'" disabled="disabled"></div><br>'+_chat_e("Приглашайте ваших друзей в Telegraf.Money и получайте по $50 кредитным бонусом на вашу карту за каждого из них. Ваши друзья также получат по $50, зарегистрировавшись по вашей ссылке.")}).then(function(){Messenger.share()})});