function init_app(){procent=.27;var e=detect.parse(navigator.userAgent);if(window.device){paramSocket.device_platform=device.platform+" "+device.version,paramSocket.device_platform_type=device.platform,paramSocket.device_browser=e.browser.family+" "+e.browser.version,paramSocket.device_uuid=device.uuid,paramSocket.device_model=device.model,"browser"!=device.platform&&Messenger.push.setup();try{"browser"!=device.platform&&init_recorder()}catch(e){console.error("init_recorder",e)}}else paramSocket.device_platform=e.os.name;window.device&&-1!=platform_style.indexOf(device.platform)?Ractive.require("src/theme/platform/"+device.platform+".css"):Ractive.require("src/theme/platform/other.css"),paramSocket.uuid=localStorage.getItem("uuid"),paramSocket.installTime=localStorage.getItem("installTime"),paramSocket.user_id=localStorage.getItem("user_id"),paramSocket.registrationId=localStorage.getItem("registrationId"),paramSocket.room=encodeURIComponent(paramURL.room),paramURL.user_id&&"ok"==localStorage.getItem("authToken")&&(delete paramSocket.uuid,delete paramSocket.installTime,delete paramSocket.registrationId,paramSocket.user_id=paramURL.user_id,paramSocket.token=encodeURIComponent(paramURL.token)),paramURL.default_page&&(paramSocket.default_page=paramURL.default_page),paramSocket&&(paramSocket.user_id||paramSocket.vip_id)?start():paramSocket.vip_id||(console.log("error parametr ws______"),localStorage.clear(),location.reload())}function jsonToUrl(e){var o="";for(var n in e)o+="&"+n+"="+e[n];return o.replace("&","?")}function getRandomInt(e,o){return Math.floor(Math.random()*(o-e+1))+e}function Emit(e){try{var o=JSON.stringify(e);socket&&socket.send&&socket.send(o)}catch(o){console.warn("[WSS] EMIT No valid JSON:,",o,"\n\t",e)}}function API(e,o,n,t,c){if(!e||"string"!=typeof e||""==e)return console.error("[API] error emit ,",e,o,n);"function"==typeof n&&(c=t,t=n,n=!1),Emit(n?{event:"api/public",data:{method:e,data:o}}:{event:"api",data:{method:e,data:o}}),"function"==typeof t&&(n?onEmiter.hasOwnProperty("API_Response_public_"+e)||(onEmiter["API_Response_public_"+e]=t):onEmiter.hasOwnProperty("API_Response_"+e)||(onEmiter["API_Response_"+e]=t),c&&(n?onEmiter["API_Response_public_"+e]=t:onEmiter["API_Response_"+e]=t))}function start(){(socket=new WebSocket("wss://"+host+"/"+pathSoket+jsonToUrl(paramSocket),["soap","wamp"])).onopen=function(){console.log("[WSS] Соединение установлено.",paramSocket.device_browser,paramSocket.device_platform,paramSocket.device_uuid),countConn=0,procent=.3,clearTimeout(auth_timeout),auth_timeout=setTimeout(function(){Messenger.auth({status:!1,error:"client timeout auth App.element.js (157)"})},3e4),ncoonect&&ncoonect.close&&ncoonect.close()},socket.onclose=function(e){e.wasClean?console.log("[WSS] Соединение закрыто чисто"):(setTimeout(function(){countConn<5&&countConn++,start()},deleyConnect[countConn]),console.log("[WSS] Обрыв соединения")),ncoonect&&ncoonect.close&&ncoonect.close(),countConn>1&&(ncoonect=noty({text:_chat_e("Не удается установить соединение. Проверьте подключение к интернету"),type:"error",theme:"metroui",layout:"top",timeout:deleyConnect[countConn]-100,progressBar:!0})),clearTimeout(auth_timeout),console.log("[WSS] Close Connection. Code:"+e.code+" Reason:"+e.reason)},socket.onmessage=function(e){try{var o=JSON.parse(e.data)}catch(o){console.warn("[WSS] onmessage No valid JSON:\n\t",e.data)}console.log(o),o&&o.event&&onEmiter.hasOwnProperty(o.event)?o.data?onEmiter[o.event](o.data):onEmiter[o.event]():console.warn("[WSS] Warn onEmiter(event) \n\tObject: ",o)},socket.onerror=function(e){Messenger.serverDisconnect(),clearTimeout(auth_timeout),procent=.3,console.log("[WSS] Error "+e.message)}}function reCapth(e,o){API("recaptcha_testing_job",{r:e,hesh:guid()},!1,function(e){e&&e.status&&"ok"==e.status?swal.close():grecaptcha.reset()})}function reCapthErr(){grecaptcha.reset()}function save_pos_caret(){if(window.getSelection)var e=window.getSelection();return e.getRangeAt&&e.rangeCount?e.getRangeAt(0):document.selection&&document.selection.createRange?document.selection.createRange():void 0}function autosize(){var e=document.getElementById("send_text");setTimeout(function(){e.style.cssText="height:auto; padding:0",e.style.cssText="height:"+e.scrollHeight+"px"},0)}function spliceString(e,o,n,t){var c=e.split("");return c.splice(o,n,t),c.join("")}function select_smile(e){var o,n;o=window.getSelection(),(n=pos_caret||{startOffset:0}).deleteContents();var t=document.createElement("img");t.className="icon "+e+" smile-22",t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",t["data-smile"]=e,n.insertNode(t),n.setStartAfter(t),o.removeAllRanges(),o.addRange(n)}function stopRecording(e){e?(audioRecorder.finishRecording(),audioRecorder.options.encodeAfterRecord):audioRecorder.cancelRecording()}function guid(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}var o=(new Date).getTime();return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-t"+o}function _find(e,o,n){for(var t=0;t<e.length;t++)if(e[t][o]==n)return t;return!1}function __link(e,o){var n=0;if(window.device&&device.uuid){var t=cordova.ThemeableBrowser.open(e,"_blank",{statusbar:{color:"#ffffffff"},toolbar:{height:44,color:"#f0f0f0ff"},title:{color:"#003264ff",showPageTitle:!0},backButton:{image:"back",imagePressed:"back_pressed",align:"left",event:"backPressed"},forwardButton:{image:"forward",imagePressed:"forward_pressed",align:"left",event:"forwardPressed"},closeButton:{wwwImage:"src/img/arrow-l-c_webview.png",wwwImagePressed:"src/img/arrow-l-c_webview.png",wwwImageDensity:2,align:"center",event:"closePressed"},backButtonCanClose:!0}).addEventListener("backPressed",function(e){t.close()}).addEventListener(cordova.ThemeableBrowser.EVT_ERR,function(e){console.error(e.message)}).addEventListener(cordova.ThemeableBrowser.EVT_WRN,function(e){console.log(e.message)});t.addEventListener("loadstop",function(e){e.url.match("mobile/close")&&(t.close(),swal.close(),o&&o()),n++}),t.addEventListener("exit",function(){swal.close()})}else window.open(e,"_system","location=no")}function bonus(e){bonus_tab=e,"review"==e&&Messenger.setPage("bonus","review"),"popup_review"==e&&(!localStorage.getItem("review_bonus")||localStorage.getItem("review_bonus")<(new Date).getTime()-1728e5)&&(localStorage.setItem("review_bonus",(new Date).getTime()+144e6),localStorage.setItem("review_bonus",(new Date).getTime()))}var $=jQuery,platform_style=["Android","iOS","MacOS","Windows","browser"];window._version_app||(window._version_app="0.0.1");var paramSocket={version_app:window._version_app,uuid:localStorage.getItem("uuid"),installTime:localStorage.getItem("installTime"),user_id:localStorage.getItem("user_id"),registrationId:localStorage.getItem("registrationId"),exchange:"off",chat:"on",globalChat:"on"},web3=new Web3,WtcApp=Ractive.extend({oninit:function(){navigator&&navigator.splashscreen&&navigator.splashscreen.hide(),procent=.28,$("nav#menu").mmenu({}),$("input, select").styler({selectSearch:!0}),Messenger.finance.callback_save(function(e,o,n){if(e&&0!=e.length){var t=0,c=0,a=0,i=-1;for(var r in e)e.hasOwnProperty(r)&&(t+=e[r].total_balance,c+=e[r].last_balance,i<=e[r].total_balance&&(i=e[r].total_balance,a=e[r].card_currency));setTimeout(function(){var e={GBP:"£",USD:"$",EUR:"€"};ractiveComponent.rootApp.set("balance_user",[t.toFixed(2),c.toFixed(2),e[a]])},10)}}),$(".responsive").slick({dots:!1,arrows:!1,infinite:!1,speed:500,slidesToShow:1,slidesToScroll:1}),$("#accordion").accordion({heightStyle:"content",collapsible:!0}),setTimeout(init_app,100),ractiveComponent.rootApp.on("setPage",function(e,o,n,t){window.Messenger&&Messenger.event[e.name]&&Messenger.event[e.name](o,n,t)}),ractiveComponent.rootApp.on("setSmileType",function(e,o,n,t){ractiveComponent.rootApp.set("smile_type",o),$(".__nano").nanoScroller()}),web3.setProvider(new web3.providers.HttpProvider("https://api.myetherapi.com/eth")),Messenger.setPage("debitcoin"),ractiveComponent.rootApp.set("smile_type","standart"),ractiveComponent.rootApp.set("smile",{standart:["icon-angry-1","icon-angry","icon-bored-1","icon-bored-2","icon-bored","icon-confused-1","icon-confused","icon-crying-1","icon-crying","icon-embarrassed","icon-emoticons","icon-happy-1","icon-happy-2","icon-happy-3","icon-happy-4","icon-happy","icon-ill","icon-in-love","icon-kissing","icon-mad","icon-nerd","icon-ninja","icon-quiet","icon-sad","icon-secret","icon-smart","icon-smile","icon-smiling","icon-surprised-1","icon-surprised","icon-suspicious-1","icon-suspicious","icon-tongue-out-1","icon-tongue-out","icon-unhappy","icon-wink"],finance:["icon-atm-1","icon-atm-2","icon-atm","icon-bag-1","icon-bag-2","icon-bag-3","icon-bag-4","icon-bag-5","icon-bag-6","icon-bag","icon-bank","icon-barbershop","icon-barcode-1","icon-barcode","icon-basket-1","icon-basket-2","icon-basket","icon-box-1","icon-box-2","icon-box-3","icon-box","icon-briefcase-1","icon-briefcase","icon-calculator","icon-cart-1","icon-cart-10","icon-cart-11","icon-cart-12","icon-cart-13","icon-cart-14","icon-cart-15","icon-cart-16","icon-cart-17","icon-cart-2","icon-cart-3","icon-cart-4","icon-cart-5","icon-cart-6","icon-cart-7","icon-cart-8","icon-cart-9","icon-cart","icon-cashier-1","icon-cashier","icon-change","icon-check","icon-coin-1","icon-coin-10","icon-coin-2","icon-coin-3","icon-coin-4","icon-coin-5","icon-coin-6","icon-coin-7","icon-coin-8","icon-coin-9","icon-coin","icon-cashier-1","icon-cashier","icon-change","icon-check","icon-coin-1","icon-coin-10","icon-coin-2","icon-coin-3","icon-coin-4","icon-coin-5","icon-coin-6","icon-coin-7","icon-coin-8","icon-coin-9","icon-coin","icon-coins-1","icon-coins","icon-crate-1","icon-crate-2","icon-crate-3","icon-crate-4","icon-crate-5","icon-crate","icon-credit-card-1","icon-credit-card-2","icon-credit-card-3","icon-credit-card-4","icon-credit-card-5","icon-credit-card-6","icon-delivery-cart-1","icon-delivery-cart","icon-diagram-1","icon-diagram-2","icon-diagram-3","icon-diagram","icon-folder-1","icon-folder","icon-get-money","icon-graph-1","icon-graph-2","icon-graph-3","icon-graph-4","icon-graph-5","icon-graph-6","icon-graph-7","icon-graph-8","icon-graph","icon-grocery-1","icon-grocery","icon-insert-coin","icon-investment","icon-justice-scale","icon-justice","icon-megaphone","icon-money","icon-notes-1","icon-notes-2","icon-notes","icon-open","icon-pack","icon-pie-chart-1","icon-pie-chart-2","icon-pie-chart-3","icon-pie-chart-4","icon-pie-chart-5","icon-pie-chart-6","icon-pie-chart","icon-piggy-bank-1","icon-piggy-bank","icon-point-of-service","icon-poor","icon-presentation-1","icon-presentation-10","icon-presentation-11","icon-presentation-12","icon-presentation-13","icon-presentation-14","icon-presentation-15","icon-presentation-16","icon-presentation-17","icon-presentation-18","icon-presentation-19","icon-presentation-2","icon-presentation-3","icon-presentation-4","icon-presentation-5","icon-presentation-6","icon-presentation-7","icon-presentation-8","icon-presentation-9","icon-presentation","icon-price-tag-1","icon-price-tag-2","icon-price-tag-3","icon-price-tag-4","icon-price-tag-5","icon-price-tag-6","icon-price-tag-7","icon-price-tag-8","icon-price-tag-9","icon-price-tag","icon-receipt","icon-record","icon-rewind-time","icon-rich","icon-safebox-1","icon-safebox-2","icon-safebox-3","icon-safebox-4","icon-safebox","icon-stamp-1","icon-stamp","icon-stand","icon-store-1","icon-store-2","icon-store-3","icon-store","icon-strongbox","icon-suitcase-1","icon-suitcase-2","icon-suitcase","icon-time-is-money","icon-time-passing","icon-wallet-1","icon-wallet-2","icon-wallet","icon-yen"]}),$("#contentMessageScroll").nanoScroller({preventPageScrolling:!0,tabIndex:-1,iOSNativeScrolling:!0}),$("#contentMessageScroll").bind("scrolltop",function(e){}),$("#contentMessageScroll").bind("update",function(e,o){"function"==typeof Messenger.chat.onscroll&&Messenger.chat.onscroll(o)}),$(".__nano").nanoScroller()},onrender:function(){},oncomplete:function(){}});moment.locale(_e("lang"));var scroll_page=[],port=3001,host="ws.telegraf.money",pathSoket="socket/v1",paramURL=param_url_this();if(localStorage.getItem("font_theme")&&Ractive.require("src/theme/font/"+localStorage.getItem("font_theme")+".css"),localStorage.getItem("theme"))switch(localStorage.getItem("theme")){case"orange":Ractive.require("src/theme/orange.css");break;case"blue_dark":Ractive.require("src/theme/blue_dark.css");break;case"dark-black":Ractive.require("src/theme/dark-black.css");break;case"dark-purple":Ractive.require("src/theme/dark-purple.css");break;case"dark-green":Ractive.require("src/theme/dark-green.css");break;case"flowers":Ractive.require("src/theme/flowers.css");break;case"telegram":Ractive.require("src/theme/telegram.css");break;case"purple":Ractive.require("src/theme/purple.css");break;case"green":Ractive.require("src/theme/green.css")}paramSocket.vip_id=paramURL.vip_id,paramSocket.vip_secret=paramURL.vip_secret,paramSocket.api_key=paramURL.api_key;var socket,countConn=0,deleyConnect=[500,2e3,4e3,6e3,1e4,getRandomInt(15e3,25e3)],WebSocket=window.WebSocket||window.MozWebSocket;window.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,window.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction,window.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange;var auth_timeout,ncoonect,onEmiter={auth:function(e){Messenger.auth(e)},auth_emit:function(e){console.error("[Error auth Emiter server]:",e)},error_bot:function(e){swal({title:"",html:'<center><div id="recaptcha" ></div></center>',width:350,showCancelButton:!1,showConfirmButton:!1}),grecaptcha.render("recaptcha",{sitekey:"6LcYxAoUAAAAABDh_cMCL3q_z0D_LBZ_I-62HZUP",callback:"reCapth","expired-callback":reCapthErr})},message_telegraf:function(e){Messenger.chat.message(e)},message_telegraf_read:function(e){Messenger.chat.read_this_chat(e)}};ractiveComponent.rootApp.set("message_enter_length",0),document.querySelector("#send_text[contenteditable]").addEventListener("keyup",function(e){ractiveComponent.rootApp.set("message_enter_length",e.target.outerText.length),window.pos_caret=save_pos_caret(),autosize(e)}),document.querySelector("#send_text[contenteditable]").addEventListener("click",function(e){window.pos_caret=save_pos_caret()}),document.querySelector("#send_text[contenteditable]").addEventListener("paste",function(e){e.preventDefault();var o=e.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,o),ractiveComponent.rootApp.set("message_enter_length",e.target.outerText.length+o.length),autosize(e)}),ractiveComponent.rootApp.set("send_wait",!1);var send_wait=!1;ractiveComponent.rootApp.on("send_message",function(e){if(!send_wait){ractiveComponent.rootApp.set("send_wait",!0),send_wait=!0;var o=$("#send_text"),n=o.html().replace("&nbsp;","");n.length<1||n.length>1e3&&56685778!=+MyProfile.webtransfer_id?o.val(n):(Messenger.chat.send(n),o.html("")),document.getElementById("send_text").focus(),autosize()}}),ractiveComponent.rootApp.set("record","end"),ractiveComponent.rootApp.on("start_record",function(e){return window.navigator&&navigator.vibrate&&navigator.vibrate(70),swal({title:_chat_e("Ошибка записи"),text:"Voice Message SOON",customClass:"swal-telegraf-modal",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",showCancelButton:!1,type:"error",confirmButtonText:_chat_e("ОК"),showLoaderOnConfirm:!0})}),setInterval(function(){Messenger.finance.cb_function_arr.length>=1&&Messenger.finance.update()},4e4),setInterval(function(){var e=ractiveComponent.rootApp.get("open_threads");e&&e.last_online_at&&(e.last_online=moment(e.last_online_at,moment.ISO_8601).fromNow(),ractiveComponent.rootApp.set("open_threads",e))},3e4),Messenger.on("openCard",function(e){"add"==e&&(swal({customClass:"swal-telegraf-modal select-form text-center",title:_chat_e("Активация карты..."),closeOnConfirm:!1,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!0,showCancelButton:!1,showLoaderOnConfirm:!0,text:_chat_e("Активация карты может занять несколько минут"),preConfirm:function(){return new Promise(function(e,o){setTimeout(function(){e()},3e4)})}}),Messenger.finance.callback_save(function(e,o,n){return swal({customClass:"swal-telegraf-modal select-form",buttonsStyling:!1,confirmButtonClass:"button-n",title:_chat_e("Ошибка заказа карты"),text:_chat_e("У вас уже  есть активная пластиковая карта вы можете перезаказать ее."),type:"info",confirmButtonColor:"#3085d6",showCancelButton:!1})})),Messenger.cardID=e,Messenger.setPage("info_card")});var get_finance_data_this_user_int,bonus_brouser;Messenger.on("add_share",function(e,o){if($("nav#menu").data("mmenu").close(),bonus_brouser&&"function"==typeof bonus_brouser&&MyProfile)return bonus_brouser&&bonus_brouser(MyProfile.webtransfer_id);setTimeout(function(){if(bonus_brouser&&"function"==typeof bonus_brouser&&MyProfile)return bonus_brouser&&bonus_brouser(MyProfile.webtransfer_id);swal({title:_chat_e("Добавить партнера"),customClass:"swal-telegraf-modal",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",confirmButtonText:_chat_e("Поделиться"),cancelButtonText:_chat_e("Закрыть"),showCancelButton:!0,html:_chat_e("Ваша реферальная ссылка: ")+'<br><div class="select-form"><input class="form-control" value="https://telegraf.money/?ref='+MyProfile.webtransfer_id+'" ></div><br>'+_chat_e("Приглашайте ваших друзей в Telegraf.Money и получайте по $50 кредитным бонусом на вашу карту за каждого из них. Ваши друзья также получат по $50, зарегистрировавшись по вашей ссылке.")}).then(function(){Messenger.share()})},500)}),Messenger.on("setPage",function(e,o){Messenger.setPage(e,o)}),Messenger.on("outlogin",function(e,o){$("nav#menu").data("mmenu").close(),setTimeout(function(){swal({customClass:"swal-telegraf-modal select-form",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",cancelButtonText:_chat_e("Отмена"),title:_chat_e("Внимание!"),text:_chat_e("Вы действительно хотите выйти из аккаунта?"),type:"warning",confirmButtonColor:"#3085d6",showCancelButton:!0,confirmButtonText:_chat_e("Выйти"),showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(e,o){var n=setTimeout(function(){o(_chat_e("Ошибка сервер недоступен.")),localStorage.clear(),location.reload()},6e3);API("logout_this_user",{code:localStorage.getItem("installTime"),uuid:localStorage.getItem("uuid")},!0,function(t){t.success?(clearTimeout(n),localStorage.clear(),e()):(clearTimeout(n),o(_chat_e("Ошибка сервер недоступен.")))})})},allowOutsideClick:!1}).then(function(){location.reload(),swal.closeModal()})},10)});var timeoutUpdate_threads=!1;Messenger.on("openChats",function(e){Messenger.openChat(Messenger.threads.data[e])}),ractiveComponent.rootApp.set("scanUserByID_status",{});var timeout_scanUserByID;Messenger.on("scanUserByID",function(e,o){clearTimeout(timeout_scanUserByID);var n=0;"key"==o&&(n=1e3),timeout_scanUserByID=setTimeout(function(){ractiveComponent.hasOwnProperty(e)&&(ractiveComponent[e].set("scanUserByID_status","load"),API("userInfo",{webtransfer_id:$("#User-"+e).val()},function(o){1==o.success?(ractiveComponent[e].set("scanUserByID",o),ractiveComponent[e].set("scanUserByID_status","ok")):ractiveComponent[e].set("scanUserByID_status","err")},!0))},n)});var page_load_messenger=!1;Messenger.threads.callback_save("App",function(e){0!=e.length||page_load_messenger||(Messenger.setPage("debitcoin"),page_load_messenger=!0),ractiveComponent.rootApp.set("threads",e),ractiveComponent.rootApp.set("threads_finish",Messenger.threads.finish)});var bonus_tab="",svg_rating='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 472.615 472.615" style="enable-background:new 0 0 472.615 472.615; width: 60px;height: 60px;padding: 5px" xml:space="preserve"><g> <g><polygon points="472.615,183.253 297.148,176.296 236.308,11.566 175.468,176.296 0,183.253 137.868,292.02 90.262,461.05     236.308,363.541 382.355,461.05 334.748,292.02   " style="fill: rgb(255, 218, 68);"></polygon> </g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> </svg>';localStorage.getItem("review_bonus");