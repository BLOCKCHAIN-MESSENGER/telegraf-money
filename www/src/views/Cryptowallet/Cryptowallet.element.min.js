function GweiByID(t){return{1:3,2:9,3:15,4:21,5:30,6:40}[t]}function updateWalletOfCloudServer(t){swal({customClass:"swal-telegraf-modal select-form text-center",title:_chat_e("Скачивание кошельков из облака Telegraf.money"),closeOnConfirm:!1,allowOutsideClick:!1,showConfirmButton:!0,showCancelButton:!1,showLoaderOnConfirm:!0,text:_chat_e("Может занять несколько секунд"),preConfirm:function(){return new Promise(function(t,e){setTimeout(function(){t()},1e4)})}}),swal.showLoading();var e=setTimeout(function(){swal.close(),noty({text:_chat_e("Не удалось скачать кошельки, из облака Telegraf.money"),type:"warning",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}})},1e4);API("cloudGetCryproWallet",{},!1,function(t){t.wallets.forEach(function(t){"ETH"===t.type&&Messenger.crypto.add(t.wallet.address,"DBC",t.wallet.PrivateKey),Messenger.crypto.add(t.wallet.address,t.type,t.wallet.PrivateKey)}),swal.close(),clearTimeout(e)},!0)}function loadSubTab(t){ractiveComponent["wtc-CryptowalletApp"].set("sub_tab",t);var e=ractiveComponent["wtc-CryptowalletApp"].get("wallet");"tx"===t&&(ractiveComponent["wtc-CryptowalletApp"].set("transactions_load",!1),"DBC"===e.type&&ethplorer("getAddressHistory",e.address,{apiKey:"freekey",token:_address},{},function(t){console.log(t);for(var o in t.operations){var a=moment(new Date(1e3*t.operations[o].timestamp)),n=a.format("DD.MM.YYYY"),r=a.format("HH:mm");t.operations[o].date=n,t.operations[o].time=r,t.operations[o].type_="+",t.operations[o].hash=t.operations[o].hash||t.operations[o].transactionHash,t.operations[o].value=+(+t.operations[o].value/_contract_fixed).toFixed(4),t.operations[o].from===e.address&&(t.operations[o].type_="-")}ractiveComponent["wtc-CryptowalletApp"].set("transactions",t.operations),ractiveComponent["wtc-CryptowalletApp"].set("transactions_load",!0)}),"ETH"===e.type&&etherscan("api","",{module:"account",action:"txlist",address:e.address,page:"1",offset:"30",sort:"desc",apikey:"freekey"},{},function(t){console.log(t);for(var o in t.result){var a=moment(new Date(1e3*t.result[o].timeStamp)),n=a.format("DD.MM.YYYY"),r=a.format("HH:mm");t.result[o].date=n,t.result[o].time=r,t.result[o].value=+(+t.result[o].value/1e18).toFixed(8),t.result[o].value>1?t.result[o].value=t.result[o].value.toFixed(4):t.result[o].value>.29?t.result[o].value=t.result[o].value.toFixed(5):t.result[o].value>.1&&(t.result[o].value=t.result[o].value.toFixed(6)),t.result[o].fee=+(+t.result[o].gasPrice*+t.result[o].cumulativeGasUsed/1e20).toFixed(6),t.result[o].type_="+",t.result[o].from===e.address&&(t.result[o].type_="-")}ractiveComponent["wtc-CryptowalletApp"].set("transactions",t.result),ractiveComponent["wtc-CryptowalletApp"].set("transactions_load",!0)}),"BTC"===response.type&&(ractiveComponent["wtc-DebitcoinApp"].set("transactions",[]),ractiveComponent["wtc-DebitcoinApp"].set("transactions_load"+response.type,!0)))}var contract=web3.eth.contract(abi).at(_address),WtcCryptowallet=Ractive.extend({oninit:function(){console.log("Cryptowallet.oninit !"),ractiveComponent["wtc-CryptowalletApp"].set("crypto_wallets",Messenger.crypto.wallets),ractiveComponent["wtc-CryptowalletApp"].set("load",!0),ractiveComponent["wtc-CryptowalletApp"].set("showPrivate_",!1),ractiveComponent["wtc-CryptowalletApp"].set("sub_tab","tx"),ractiveComponent["wtc-CryptowalletApp"].get("tab")||ractiveComponent["wtc-CryptowalletApp"].set("tab","all")},onrender:function(){console.log("Cryptowallet.onrender !")},oncomplete:function(){console.log("Cryptowallet.oncomplete !")}});if(ractiveComponent["wtc-CryptowalletApp"].set("usd",{ETH:0,BTC:0,DBC:1}),localStorage.getItem("installTime")&&"crypto.wallet.eth.auth"===localStorage.getItem("installTime")){var priv=localStorage.getItem("walletPrivateKey"),address_my=keythereum.privateKeyToAddress(priv);Messenger.crypto.add(address_my,"ETH",priv,!0),Messenger.crypto.add(address_my,"DBC",priv,!0)}Messenger.crypto.update(),$.ajax({url:"https://api.coinmarketcap.com/v1/ticker/ethereum/",type:"get",success:function(t){try{ractiveComponent["wtc-CryptowalletApp"].set("usd.ETH",t[0].price_usd)}catch(t){console.error("ERROR parse coinmarketcap",t)}}}),$.ajax({url:"https://api.coinmarketcap.com/v1/ticker/bitcoin/",type:"get",success:function(t){try{ractiveComponent["wtc-CryptowalletApp"].set("usd.BTC",t[0].price_usd)}catch(t){console.error("ERROR parse coinmarketcap",t)}}});var clipboard99=new Clipboard("#basic-addon2299"),clipboard=new Clipboard("#basic-addon22"),clipboard2=new Clipboard("#basic-addon222"),clipboard233=new Clipboard("#basic-addon22233");clipboard99.on("success",function(t){noty({text:_chat_e("Успешно!")+"<br>"+_chat_e("Адрес скопирован в буфер обмена."),type:"success",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}}),t.clearSelection()}),clipboard99.on("error",function(t){window.prompt(_chat_e("Скопировать в буфер обмена: Ctrl + C, Enter"),$("#address-wallet-inp-get").val())}),clipboard.on("success",function(t){noty({text:_chat_e("Успешно!")+"<br>"+_chat_e("Адрес скопирован в буфер обмена."),type:"success",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}}),t.clearSelection()}),clipboard.on("error",function(t){window.prompt(_chat_e("Скопировать в буфер обмена: Ctrl + C, Enter"),$("#address-wallet-inp-get").val())}),clipboard2.on("success",function(t){noty({text:_chat_e("Успешно!")+"<br> Partner "+_chat_e("Адрес скопирован в буфер обмена."),type:"success",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}}),t.clearSelection()}),clipboard2.on("error",function(t){window.prompt(_chat_e("Скопировать в буфер обмена: Ctrl + C, Enter"),$("#address-wallet-inp-get").val())}),clipboard233.on("success",function(t){noty({text:_chat_e("Успешно!")+"<br> "+_chat_e("Адрес скопирован в буфер обмена."),type:"success",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}}),t.clearSelection()}),clipboard233.on("error",function(t){window.prompt(_chat_e("Скопировать в буфер обмена: Ctrl + C, Enter"),$("#address-wallet-inp-get").val())}),lsbridge.subscribe("crypto_wallets",function(t){console.log("crypto_wallets",t),ractiveComponent["wtc-CryptowalletApp"].set("crypto_wallets",t)}),ractiveComponent["wtc-CryptowalletApp"].on("barcodeScanner",function(t,e){cordova.plugins.barcodeScanner.scan(function(t){if(!(t&&t.text&&t.text.length<10&&t.text.length>=60))return swal({customClass:"swal-telegraf-modal select-form text-center",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",title:_chat_e("Уппс..."),type:"error",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:_chat_e("QR-Код не является адресом кошелька")});$("#address-wallet-inp").val(t.text),$("#address-wallet-i").css("color","#00f317")},function(t){return swal({customClass:"swal-telegraf-modal select-form text-center",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",title:_chat_e("Уппс..."),type:"error",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:_chat_e("Ошибка QR-Кода")})},{preferFrontCamera:!1,showFlipCameraButton:!0,showTorchButton:!0,torchOn:!1,prompt:_chat_e("Поместите QR-Код внутри области сканирования"),resultDisplayDuration:500,formats:"QR_CODE",orientation:"landscape",disableAnimations:!1,disableSuccessBeep:!1})}),ractiveComponent["wtc-CryptowalletApp"].on("setSubTab",function(t,e){loadSubTab(e)}),ractiveComponent["wtc-CryptowalletApp"].on("showPrivate",function(t,e){var o=ractiveComponent["wtc-CryptowalletApp"].get("wallet");return ractiveComponent["wtc-CryptowalletApp"].set("showPrivate_",!ractiveComponent["wtc-CryptowalletApp"].get("showPrivate_")),ractiveComponent["wtc-CryptowalletApp"].set("debit_tokenPrivateKey",o.privateKey)}),ractiveComponent["wtc-CryptowalletApp"].on("keyStoreFile",function(t){return swal({customClass:"swal-telegraf-modal select-form text-center",title:_chat_e("Загрузка..."),closeOnConfirm:!1,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!0,showCancelButton:!1,showLoaderOnConfirm:!0,text:_chat_e("Подготовка к скачиванию Keystore File"),preConfirm:function(){return new Promise(function(t,e){setTimeout(function(){t()},1e4)})}}),swal({customClass:"swal-telegraf-modal select-form text-center",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",title:_chat_e("Уппс..."),type:"error",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:"Coming soon! Please see Private Key"})}),ractiveComponent["wtc-CryptowalletApp"].on("updateWalletOfCloudServer",updateWalletOfCloudServer),ractiveComponent["wtc-CryptowalletApp"].on("AddCryptoWallet",function(){$("#newModal").modal("show")}),ractiveComponent["wtc-CryptowalletApp"].on("import_crypto_wallet_privatekey",function(){var t=$('input[name="addresstype"]:checked').val();$("#newModal").modal("hide"),"ETH"!==t&&"DBC"!==t||importFromPrivateKeyETH(function(e,o,a){Messenger.crypto.add(e,t,o,!0),noty({text:_chat_e("Кошелек успешно импортирован:")+" "+t+" "+e,type:"success",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}})})}),ractiveComponent["wtc-CryptowalletApp"].on("new_crypto_wallet",function(){var t=$('input[name="addresstype"]:checked').val();$("#newModal").modal("hide"),"ETH"!==t&&"DBC"!==t||createWalletETH(function(e,o,a){Messenger.crypto.add(e,t,o,!0),noty({text:_chat_e("Кошелек успешно создан:")+" "+t+" "+e,type:"success",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}})})}),ractiveComponent["wtc-CryptowalletApp"].on("wallet_open",function(t,e){ractiveComponent["wtc-CryptowalletApp"].set("wallet",e),ractiveComponent["wtc-CryptowalletApp"].set("tab",e.address),loadSubTab("tx")}),document.getElementById("file-input-keystore").addEventListener("change",function(t){var e=$('input[name="addresstype"]:checked').val();$("#newModal").modal("hide"),importFromKeyStoreETH(t,function(t,o,a){Messenger.crypto.add(t,e,o,!0),noty({text:_chat_e("Кошелек успешно импортирован:")+" "+e+" "+t,type:"success",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}})})},!1),ractiveComponent["wtc-CryptowalletApp"].on("openModal",function(t,e){"send"==e&&($("#cardModal2").modal(),$("#ex21").bootstrapSlider({ticks_toolti:!0,formatter:function(t){return GweiByID(t)+" Gwei"}}),setTimeout(function(){$("#ex21").bootstrapSlider("refresh")},501),setTimeout(function(){$("#ex21").bootstrapSlider("refresh")},1500)),"virualdbc"==e&&swal({title:_chat_e("Подтверждение"),type:"question",customClass:"swal-telegraf-modal select-form",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",confirmButtonText:_chat_e("Да"),cancelButtonText:_chat_e("Отменить"),showCancelButton:!0,text:_chat_e("Вы действительно хотите перевести:")+" <strong>"+ractiveComponent["wtc-DebitcoinApp"].get("finance_debit_coin_gold_virtual")+" eDBC</strong><br>"+_chat_e("На основной адрес DBC"),showLoaderOnConfirm:!0,preConfirm:function(){swal({customClass:"swal-telegraf-modal select-form text-center",title:_chat_e("Создание перевода DEBIT Coin..."),closeOnConfirm:!1,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!0,showCancelButton:!1,showLoaderOnConfirm:!0,text:"",preConfirm:function(){return new Promise(function(t,e){setTimeout(function(){t()},3e4)})}}),swal.showLoading(),API("eDBC_transfrer_DBC",{amount:ractiveComponent["wtc-DebitcoinApp"].get("finance_debit_coin_gold_virtual")},!1,function(t){return Messenger.finance.update(),t.error?swal({customClass:"swal-telegraf-modal select-form text-center",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",title:_chat_e("Уппс..."),type:"error",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:"Error:"+t.error}):swal({customClass:"swal-telegraf-modal select-form text-center",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",title:_chat_e("Успешно"),type:"success",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:_chat_e("Перевод отправлен в обработку txHash:")+" "+t.txHash})},!0)}}),"get"!==e&&"getbtc"!==e||($("#cardModal").modal(),$("#buy_debitcoin").css("display","none"),document.getElementById("qr_code_vdc2").innerHTML="",new QRCode(document.getElementById("qr_code_vdc2"),{text:ractiveComponent["wtc-CryptowalletApp"].get("wallet").address,width:170,height:170,colorDark:"#000000",colorLight:"#fff",correctLevel:QRCode.CorrectLevel.L}))}),ractiveComponent["wtc-CryptowalletApp"].on("sendCoin",function(t,e){var o="DBC",a="</strong> GasPrice: <strong>"+GweiByID($("#ex21").bootstrapSlider("getValue"))+" Gwei</strong>";if("ETH"===e&&(o="ETH"),"DBC"===e&&(o="DBC"),"BTC"===e)return a="</strong> Fee: <strong>0.0001 BTC</strong>",o="BTC",noty({text:_chat_e("Скоро"),type:"error",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}});if($("#amount-wallet-inp").val()<=0||isNaN($("#amount-wallet-inp").val()))return noty({text:_chat_e("Ошибка:")+" <br>"+_chat_e("Неверная сумма перевода"),type:"error",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}});var n=ractiveComponent["wtc-CryptowalletApp"].get("wallet").address;if(""===$("#address-wallet-inp").val()||$("#address-wallet-inp").val().length<10||$("#address-wallet-inp").val().length>60)return noty({text:_chat_e("Ошибка:")+" <br>"+_chat_e("Неверный адрес кошелька"),type:"error",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}});$("#cardModal2").modal("hide"),swal({title:_chat_e("Подтверждение"),type:"question",customClass:"swal-telegraf-modal select-form",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",confirmButtonText:_chat_e("Да"),cancelButtonText:_chat_e("Отменить"),showCancelButton:!0,text:_chat_e("Вы действительно хотите перевести:")+" <strong>"+$("#amount-wallet-inp").val()+" "+o+"</strong><br>"+_chat_e("На адрес:")+" <strong>"+$("#address-wallet-inp").val()+a,showLoaderOnConfirm:!0,preConfirm:function(){swal({customClass:"swal-telegraf-modal select-form text-center",title:_chat_e("Создание перевода..."),closeOnConfirm:!1,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!0,showCancelButton:!1,showLoaderOnConfirm:!0,text:"",preConfirm:function(){return new Promise(function(t,e){setTimeout(function(){t()},3e4)})}}),swal.showLoading(),"ETH"===o&&Crypto.transferETH({from:n,to:$("#address-wallet-inp").val(),gasPrice:GweiByID($("#ex21").bootstrapSlider("getValue")),amount:$("#amount-wallet-inp").val()},function(t){return swal({customClass:"swal-telegraf-modal select-form text-center",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",title:_chat_e("Успешно"),type:"success",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:_chat_e("Перевод отправлен в обработку txHash:")+' <a href="https://etherscan.io/tx/'+t+'" target="_blank">'+t+"</a>"})},!0),"DBC"===o&&Crypto.transferDBC({from:n,to:$("#address-wallet-inp").val(),gasPrice:GweiByID($("#ex21").bootstrapSlider("getValue")),amount:$("#amount-wallet-inp").val()},function(t){return swal({customClass:"swal-telegraf-modal select-form text-center",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",title:_chat_e("Успешно"),type:"success",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:_chat_e("Перевод отправлен в обработку txHash:")+' <a href="https://etherscan.io/tx/'+t+'" target="_blank">'+t+"</a>"})},!0)}})});