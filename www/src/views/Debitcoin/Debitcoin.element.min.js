var contract=web3.eth.contract(abi).at(_address),WtcDebitcoin=Ractive.extend({oninit:function(){console.log("Debitcoin.oninit !"),window.__crypto_wallet_dbc&&"object"==typeof window.__crypto_wallet_dbc&&window.__crypto_wallet_dbc.wallet?(ractiveComponent["wtc-DebitcoinApp"].set("debit_token",Messenger.finance.crypto_wallet_dbc),ractiveComponent["wtc-DebitcoinApp"].set("finance_debit_coin_gold",Messenger.finance.crypto_wallet_dbc.wallet.balance.dbc),ractiveComponent["wtc-DebitcoinApp"].set("finance_eth",Messenger.finance.crypto_wallet_dbc.wallet.balance.eth),ractiveComponent["wtc-DebitcoinApp"].set("finance_ethusd",Messenger.finance.crypto_wallet_dbc.wallet.balance.ethusd)):(ractiveComponent["wtc-DebitcoinApp"].set("debit_token.wallet.address","Loading..."),ractiveComponent["wtc-DebitcoinApp"].set("finance_debit_coin_gold","...")),ractiveComponent["wtc-DebitcoinApp"].set("MyProfile",MyProfile),ractiveComponent["wtc-DebitcoinApp"].set("btc_finance_btc","..."),ractiveComponent["wtc-DebitcoinApp"].set("eth_finance_eth","..."),ractiveComponent["wtc-DebitcoinApp"].set("sub_tab","wallet"),ractiveComponent["wtc-DebitcoinApp"].set("showPrivate_",!1),ractiveComponent["wtc-DebitcoinApp"].set("eth_status",!0),ractiveComponent["wtc-DebitcoinApp"].set("cryptoAccount",!1);var e=ractiveComponent["wtc-DebitcoinApp"].get("tab");if(("gold"===e||"eth"===e)&&localStorage.getItem("installTime")&&"crypto.wallet.eth.auth"===localStorage.getItem("installTime")){ractiveComponent["wtc-DebitcoinApp"].set("cryptoAccount",!0);var t=localStorage.getItem("walletPrivateKey"),n=keythereum.privateKeyToAddress(t),c={wallet:{address:n,balance:{eth:+(+web3.eth.getBalance(n)/1e18).toFixed(8),ethusd:0,dbc:(+contract.balanceOf(n)/_contract_fixed).toFixed(2)}}};ractiveComponent["wtc-DebitcoinApp"].set("debit_token",c),ractiveComponent["wtc-DebitcoinApp"].set("finance_debit_coin_gold",c.wallet.balance.dbc),$.ajax({url:"https://api.coinmarketcap.com/v1/ticker/ethereum/",type:"get",success:function(e){try{c.wallet.balance.ethusd=(c.wallet.balance.eth*e[0].price_usd).toFixed(2),ractiveComponent["wtc-DebitcoinApp"].set("finance_ethusd",c.wallet.balance.ethusd)}catch(e){console.error("ERROR parse coinmarketcap",e)}}}),ractiveComponent["wtc-DebitcoinApp"].set("finance_eth",c.wallet.balance.eth),ractiveComponent["wtc-DebitcoinApp"].set("finance_ethusd",c.wallet.balance.ethusd)}Messenger.auth_action.call_wait_auth(function(){if("gold"===e||"eth"===e)if(localStorage.getItem("installTime")&&"crypto.wallet.eth.auth"===localStorage.getItem("installTime")){ractiveComponent["wtc-DebitcoinApp"].set("cryptoAccount",!0);var t=localStorage.getItem("walletPrivateKey"),n=keythereum.privateKeyToAddress(t),c={wallet:{address:n,balance:{eth:+(+web3.eth.getBalance(n)/1e18).toFixed(8),ethusd:0,dbc:(+contract.balanceOf(n)/_contract_fixed).toFixed(2)}}};ractiveComponent["wtc-DebitcoinApp"].set("debit_token",c),ractiveComponent["wtc-DebitcoinApp"].set("finance_debit_coin_gold",c.wallet.balance.dbc),$.ajax({url:"https://api.coinmarketcap.com/v1/ticker/ethereum/",type:"get",success:function(e){try{c.wallet.balance.ethusd=(c.wallet.balance.eth*e[0].price_usd).toFixed(2),ractiveComponent["wtc-DebitcoinApp"].set("finance_ethusd",c.wallet.balance.ethusd)}catch(e){console.error("ERROR parse coinmarketcap",e)}}}),ractiveComponent["wtc-DebitcoinApp"].set("finance_eth",c.wallet.balance.eth),ractiveComponent["wtc-DebitcoinApp"].set("finance_ethusd",c.wallet.balance.ethusd),API("getPartnerTxDebitCoin",{},!1,function(e){e.partner&&e.partner[0]&&e.partner[0].referal||(e.partner=[{referal:10}]);var t=0;for(var n in e.txes){e.txes[n].period&&1!=+e.txes[n].period?2==+e.txes[n].period?.1743:3==+e.txes[n].period?.4324:4==+e.txes[n].period?.7533234:5==+e.txes[n].period?.6:6==+e.txes[n].period?.75:7==+e.txes[n].period?.6:1:.1248;var c=moment(e.txes[n].update_at),o=c.format("DD.MM.YYYY"),a=c.format("HH:mm");e.txes[n].date=o,e.txes[n].time=a,e.txes[n].partner_profit=0,"1"===e.txes[n].pay_status&&(e.txes[n].partner_profit=+(+e.txes[n].dbc/100*+e.partner[0].referal).toFixed(2)),t+=e.txes[n].partner_profit,e.txes[n].type_="+"}ractiveComponent["wtc-DebitcoinApp"].set("transactions_partner",e.txes),ractiveComponent["wtc-DebitcoinApp"].set("total_proff",t.toFixed(2)),ractiveComponent["wtc-DebitcoinApp"].set("transactions_partner_info",e.partner[0])})}else API("eth_status",{},!1,function(e){ractiveComponent["wtc-DebitcoinApp"].set("eth_status_dev",e.eth_status_dev)});"btc"===e&&(API("wallet_coin",{type:"BTC"},!1,function(e){if(e.error)return swal({customClass:"swal-telegraf-modal select-form text-center",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",title:_chat_e("Уппс...")+", "+e.err.code,type:"error",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:"Error:"+e.error});ractiveComponent["wtc-DebitcoinApp"].set("btc_debit_token",e),ractiveComponent["wtc-DebitcoinApp"].set("btc_finance_debit_coin_gold",e.wallet.balance.dbc),ractiveComponent["wtc-DebitcoinApp"].set("btc_finance_btc",e.wallet.balance.btc),ractiveComponent["wtc-DebitcoinApp"].set("btc_finance_btcusd",e.wallet.balance.btcusd)},!0),Messenger.finance.callback_save(function(e,t,n,c){c&&c.wallet&&ractiveComponent["wtc-DebitcoinApp"].set("finance_debit_coin_gold_virtual",c.wallet["debit-coin-gold"])})),Messenger.finance.callback_save(function(e,t,n,c){e&&0!=e.length||(e=!1),console.log(arguments),ractiveComponent["wtc-DebitcoinApp"].set("finance_cards",e),c&&(ractiveComponent["wtc-DebitcoinApp"].set("finance_debit_coin_silver",c.wallet["debit-coin"]),ractiveComponent["wtc-DebitcoinApp"].set("finance_cards_load",!0))})})},onrender:function(){console.log("Debitcoin.onrender !")},oncomplete:function(){console.log("Debitcoin.oncomplete !")}});