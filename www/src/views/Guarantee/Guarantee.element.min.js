for(var WtcGuarantee=Ractive.extend({data:function(){return{form:{user_id:""}}},oninit:function(){console.log("WebtransferChatGuarantee.oninit !");var e=!1;Messenger.guarantee.callback_save(function(e){ractiveComponent["wtc-GuaranteeApp"].set("orders",e)}),Messenger.finance.callback_save(function(t,n){ractiveComponent["wtc-GuaranteeApp"].set("finance_cards",t),ractiveComponent["wtc-GuaranteeApp"].set("microinvest",n),ractiveComponent["wtc-GuaranteeApp"].set("finance_cards_load",!0),e||(e=!0),Messenger.body.guarantee.callback=function(){ractiveComponent["wtc-GuaranteeApp"].set("tabPage",Messenger.body.guarantee.tabPage),$("#cards_my").styler().trigger("refresh"),$(".__nano").nanoScroller()},Messenger.body.guarantee.callback()}),$("input, select").styler({selectSearch:!0})},onrender:function(){console.log("WebtransferChatGuarantee.onrender !")},oncomplete:function(){console.log("WebtransferChatGuarantee.oncomplete !")}}),timeoutUpdate_threads=!1,arr_ammount_gr=[],i=5;i<100;i+=5)arr_ammount_gr.push({name:i+" USD",value:i});ractiveComponent["wtc-GuaranteeApp"].set("ammount_list",arr_ammount_gr);for(var arr_time_gr=[],t=1;t<31;t++)arr_time_gr.push({name:t,value:t});ractiveComponent["wtc-GuaranteeApp"].set("time_list",arr_time_gr);for(var arr_pr_gr=[],p=0;p<.51;p+=.1)arr_pr_gr.push({name:p.toFixed(1)+" %",value:p});ractiveComponent["wtc-GuaranteeApp"].set("rate_list",arr_pr_gr),ractiveComponent["wtc-GuaranteeApp"].on("create_guarant",function(e){var t=$("#guarantee_form").serializeObject();console.log(t),secure(_chat_e("Выдать гарантию"),function(e){API("create_guarant",{percent:t.percent,source:t.source,summ:t.summ,time:t.time,code:e.code,purpose:e.type,to_user_id:t.user_id},function(e){e.error?swal({customClass:"swal-telegraf-modal select-form text-center",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",title:_chat_e("Ошибка создания гарантии"),type:"error",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,text:_chat_e(e.error)}):swal({customClass:"swal-telegraf-modal select-form text-center",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",title:_chat_e("Успех"),type:"success",confirmButtonText:_chat_e("Ок"),showCancelButton:!1,html:_chat_e("Вы успешно выдали гарантию.")+"<br>"+_chat_e("Cумма:")+" "+t.summ+", "+_chat_e("Срок(дней):")+t.time+", "+_chat_e("Процент(%):")+t.percent+"<br>"+_chat_e("Сумма возврата:")+"<strong>"+(+(+t.summ*(t.percent/100)*t.time+ +t.summ)).toFixed(2)+"</strong>"}),setTimeout(Messenger.finance.update,1e3)},!0)},function(){return noty({text:_chat_e("Ошибка безопасности")+" <br>"+_chat_e("Вы не прошли проверку двух-факторной авторизации! (err_type_secure)"),type:"error",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}})})}),ractiveComponent["wtc-GuaranteeApp"].on("openGuarantee",function(e,t){$("body .guarantee-wrapper .credit-main-area .toggle .body-"+t).toggle("")}),ractiveComponent["wtc-GuaranteeApp"].on("accept",function(e,t){secure(_chat_e("Принять гарантию #")+t,function(e){Messenger.guarantee.update()})}),ractiveComponent["wtc-GuaranteeApp"].on("cancel",function(e,t){swal({title:_chat_e("Подтверждение"),type:"question",customClass:"swal-telegraf-modal select-form text-center",buttonsStyling:!1,confirmButtonClass:"button-n",cancelButtonClass:"cansel-btns",confirmButtonText:_chat_e("Подтвердить"),cancelButtonText:_chat_e("Отменить"),showCancelButton:!0,text:_chat_e("Вы действительно хотите отклонить гарантию #")+t}).then(function(){API("cancel_guarant",{id:t},!1,function(e){return Messenger.guarantee.update(),"success"==e.status?noty({text:_chat_e("Гарантия успешно удаленна"),type:"success",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}}):noty({text:_chat_e("Ошибка:")+" <br>"+e.error,type:"error",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}})})})});