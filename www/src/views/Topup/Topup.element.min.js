function calculate(t,e){var o=$("#topup_val_1").val(),a=$("#topup_val_2").val(),n=ractiveComponent["wtc-TopupApp"].get("exchange_select");t&&(a=(o/n.rate).toFixed(2),$("#topup_val_2").val((o/n.rate).toFixed(2))),e&&(o=(a*n.rate).toFixed(2),$("#topup_val_1").val((a*n.rate).toFixed(2)));var p=0;a<300?p=.3*a:a<500?p=.4*a:a>=500&&(p=.5*a),ractiveComponent["wtc-TopupApp"].set("bonus",+p.toFixed(2)),ractiveComponent["wtc-TopupApp"].set("total",+(+a+ +p).toFixed(2))}var WtcTopup=Ractive.extend({data:function(){return{}},oninit:function(){console.log("Topup.oninit !"),ractiveComponent["wtc-TopupApp"].set("MyProfile",MyProfile),Messenger.finance.callback_save(function(t){t&&0!=t.length||(t=!1),ractiveComponent["wtc-TopupApp"].set("finance_cards",t),ractiveComponent["wtc-TopupApp"].set("finance_cards_load",!0)}),ractiveComponent["wtc-TopupApp"].set("bonus",0),ractiveComponent["wtc-TopupApp"].set("total",0),"ru"==_chat_e("lang")?ractiveComponent["wtc-TopupApp"].set("pay_system",[{operation_tag:"PER",title:"PerfectMoney",img:"perfect.png",size:"50"},{operation_tag:"PAY",title:"Payeer",img:"payeer.png",style_img:"margin-top:25px;",size:"50"},{operation_tag:"OKP",title:"Okpay",img:"okpay.png",size:"50"},{operation_tag:"QIW",title:"Qiwi",img:"bl-5.png"},{operation_tag:"QIW_sberbank",title:"sberbank",img:"sberbank_block.png"},{operation_tag:"QIW_Alfabank",title:"Alfabank",img:"Alfabank_block.png"},{operation_tag:"QIW_Tinkoff",title:"Tinkoff",img:"Tinkoff_block.png"},{operation_tag:"QIW_vtb24",title:"vtb24",img:"vtb_block.png"},{operation_tag:"QIW_promsviazBank",title:"promsviazBank",img:"PromsviazBank_block.png"},{operation_tag:"QIW_unicredit",title:"unicredit",img:"unicredit_block.png"},{operation_tag:"QIW_gazprombank_block",title:"gazprombank",img:"gazprombank_block.png"},{operation_tag:"QIW_avangard",title:"avangard",img:"avangard_block.png"},{operation_tag:"PSC",title:"PaySafeCard",img:"paysafecard.png"},{operation_tag:"MRC",title:"Mistercash",img:"bl-1.png"},{operation_tag:"MLB",title:"Multibanco",img:"bl-7.png"},{operation_tag:"IDL",title:"iDEAL",img:"bl-3.png"},{operation_tag:"ABQ",title:"Abaqoos",img:"bl2-2.png"},{operation_tag:"EUT",title:"euTeller",img:"bl2-3.png"},{operation_tag:"BLK",title:"Banklink",img:"bl2-4.png"},{operation_tag:"EKO",title:"eKonto",img:"bl2-5.png"},{operation_tag:"EPS",title:"EPS",img:"bl2-6.png"},{operation_tag:"EPA",title:"ePay",img:"bl2-7.png",style_img:"margin-top:4px;"},{operation_tag:"P24",title:"Przelewy24",img:"p24.png"},{operation_tag:"SPO",title:"Sporopay",img:"bl2-9.png"}]):ractiveComponent["wtc-TopupApp"].set("pay_system",[{operation_tag:"PER",title:"PerfectMoney",img:"perfect.png",size:"50"},{operation_tag:"PAY",title:"Payeer",img:"payeer.png",style_img:"margin-top:25px;",size:"50"},{operation_tag:"OKP",title:"Okpay",img:"okpay.png",size:"50"},{operation_tag:"QIW",title:"Qiwi",img:"bl-5.png"},{operation_tag:"PSC",title:"PaySafeCard",img:"paysafecard.png"},{operation_tag:"MRC",title:"Mistercash",img:"bl-1.png"},{operation_tag:"MLB",title:"Multibanco",img:"bl-7.png"},{operation_tag:"IDL",title:"iDEAL",img:"bl-3.png"},{operation_tag:"ABQ",title:"Abaqoos",img:"bl2-2.png"},{operation_tag:"EUT",title:"euTeller",img:"bl2-3.png"},{operation_tag:"BLK",title:"Banklink",img:"bl2-4.png"},{operation_tag:"EKO",title:"eKonto",img:"bl2-5.png"},{operation_tag:"EPS",title:"EPS",img:"bl2-6.png"},{operation_tag:"EPA",title:"ePay",img:"bl2-7.png",style_img:"margin-top:4px;"},{operation_tag:"P24",title:"Przelewy24",img:"p24.png"},{operation_tag:"SPO",title:"Sporopay",img:"bl2-9.png"},{operation_tag:"QIW_sberbank",title:"sberbank",img:"sberbank_block.png"},{operation_tag:"QIW_Alfabank",title:"Alfabank",img:"Alfabank_block.png"},{operation_tag:"QIW_Tinkoff",title:"Tinkoff",img:"Tinkoff_block.png"},{operation_tag:"QIW_vtb24",title:"vtb24",img:"vtb_block.png"},{operation_tag:"QIW_promsviazBank",title:"promsviazBank",img:"PromsviazBank_block.png"},{operation_tag:"QIW_unicredit",title:"unicredit",img:"unicredit_block.png"},{operation_tag:"QIW_gazprombank_block",title:"gazprombank",img:"gazprombank_block.png"},{operation_tag:"QIW_avangard",title:"avangard",img:"avangard_block.png"}])},onrender:function(){console.log("Topup.onrender !")},oncomplete:function(){console.log("Topup.oncomplete !")}});ractiveComponent["wtc-TopupApp"].on("back",function(t,e){ractiveComponent["wtc-TopupApp"].set("exchanges_page",!1)}),ractiveComponent["wtc-TopupApp"].on("order_pay",function(t,e){var o=$("#topup_val_1").val(),a=ractiveComponent["wtc-TopupApp"].get("exchange_select"),n=ractiveComponent["wtc-TopupApp"].get("pay_select"),p=ractiveComponent["wtc-TopupApp"].get("select_card");if(isNaN(+o)||+o<1)return noty({text:_chat_e("Сумма не может быть меньше")+" <strong>1 USD</strong>",type:"error",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}});swal({customClass:"swal-telegraf-modal select-form text-center",title:_chat_e("Загрузка..."),closeOnConfirm:!1,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!0,showCancelButton:!1,showLoaderOnConfirm:!0,text:_chat_e("Создание заявки!"),preConfirm:function(){return new Promise(function(t,e){setTimeout(function(){t()},3e4)})}}),swal.showLoading(),console.log({exchange_id:a.exchanger_id,from:n.operation_tag,amount:o,cloud_card_id:p,currency_card:"USD"}),API("topup_card",{exchange_id:a.exchanger_id,from:n.operation_tag,amount:o,cloud_card_id:p,currency_card:"USD"},!1,function(t){if(t.error)return swal.close(),noty({text:_chat_e("Ошибка: ")+t.error,type:"error",theme:"metroui",layout:"topCenter",timeout:4e3,progressBar:!0,animation:{open:"animated fadeInDown",close:"animated fadeOutUp"}});t.data.data.length==[]||t.data.data.length?ractiveComponent["wtc-TopupApp"].set("form",t.data):ractiveComponent["wtc-TopupApp"].set("form",{link:"https://telegraf.money/redirect?link="+t.data.link+"&post="+encodeURIComponent(JSON.stringify(t.data.data))}),setTimeout(function(){console.log($("#pay_start")[0]),$("#pay_start")[0].click()},300),console.log(t.data),setTimeout(function(){ractiveComponent["wtc-TopupApp"].set("exchanges_page",!1),ractiveComponent["wtc-TopupApp"].set("topup_select",!1),swal.close()},1e3)},!0)}),ractiveComponent["wtc-TopupApp"].on("selectPay",function(t,e){swal({customClass:"swal-telegraf-modal select-form text-center",title:_chat_e("Загрузка..."),closeOnConfirm:!1,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!0,showCancelButton:!1,showLoaderOnConfirm:!0,text:_chat_e("Загрузка Списка обменников с системы:")+" "+e.title,preConfirm:function(){return new Promise(function(t,e){setTimeout(function(){t()},3e4)})}}),swal.showLoading(),API("merchant_exchange_rate",{from:e.operation_tag},!1,function(t){ractiveComponent["wtc-TopupApp"].set("exchanges_page",!0),ractiveComponent["wtc-TopupApp"].set("topup_select",!1),ractiveComponent["wtc-TopupApp"].set("exchanges",t.data),ractiveComponent["wtc-TopupApp"].set("pay_select",e),setTimeout(function(){swal.close()},100)},!0)}),ractiveComponent["wtc-TopupApp"].on("selectExchange",function(t,e){ractiveComponent["wtc-TopupApp"].set("topup_select",!0),ractiveComponent["wtc-TopupApp"].set("exchange_select",e),calculate(null,!0)}),ractiveComponent["wtc-TopupApp"].on("back_topup",function(t,e){ractiveComponent["wtc-TopupApp"].set("topup_select",!1),ractiveComponent["wtc-TopupApp"].set("exchange_select",null)});